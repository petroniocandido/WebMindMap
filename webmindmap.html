<html>
<head>
		<link rel="stylesheet" href="webmindmap.css" type="text/css" media="screen" />
</head>
<body>
	<div id="xy">MOUSE XY</div>
	<canvas id="myCanvas" width="878" height="300"></canvas>
	<br />
	<span id="edit_button">Editar</span>
	<div id="details_panel">
		<div class="colorpicker">
			<div id="colorpicker"></div>
		</div>
		<form>
			<p>Cor: <input type="text" id="color" /></p>
			<p>Conteúdo: <textarea id="content" cols="45" rows="5"></textarea></p>
		</form>
	</div>
	<script src="jquery-1.4.3.js"></script>
	<script type="text/javascript" charset="utf-8" src="farbtastic/src/farbtastic.js"></script>
	<script src="webmindmap.js"></script>
    <script type="text/javascript" >
		$(document).ready(function() {
				var pai = new Node();
				pai
					.setX(250)
					.setY(200)
					.setContent('Pai - Nó raiz')
					.setFillColor('blue');
				xMindMap.setRootNode(pai);
				xMindMap.Show();
				
				$('#myCanvas')
					.click(UIController.OnMouseClick)
					.click(function() {
						$('#details_panel').hide();
						$(document).keydown(UIController.OnKeyPressed);
					})
					.dblclick(function() {
						$('#edit_button').click();
						$('#content').focusin();
					})
					.mousedown(UIController.OnMouseDown)
					.mouseup(UIController.OnMouseUp);
				$(document).keydown(UIController.OnKeyPressed);
				$('#content')
					.focusin(function(){
						$(document).unbind('keydown');
					}).focusout(function(){
						$(document).keydown(UIController.OnKeyPressed);
					}).change(function(){
						xMindMap.getSelectedNode().setContent($('#content').val()); 
						xMindMap.Show();
					});
				$('#details_panel').hide();
				$('#edit_button').click(function(){ $('#details_panel').toggle();  });
				$('#colorpicker').farbtastic(function(color){
					if(xMindMap.getSelectedNode() != null){
						xMindMap.getSelectedNode().setFillColor(color); 
						xMindMap.Show();
					}
				});
				
				xMindMap.setOnChangeNode(function() { 
					//$('#content').val(xMindMap.getSelectedNode().content); 
					$('#details_panel').hide();
				});
  
			});
	</script>
</body>
</html>